<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>
<body>
  <div class="container m-4">
    <h1>Add Document Form</h1>
    <form id="submit-form">
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="inputfullname">Full Name</label>
          <input type="text" class="form-control" id="inputfullname" name="Full Name" placeholder="Full Name">
        </div>
        <div class="form-group col-md-6">
          <label for="inputsex">Sex</label>
          <select id="inputsex" class="form-control" name="Sex/Gender">
            <option selected>Choose...</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Prefer not to say">Prefer not to say</option>
          </select>
        </div>
      </div>
      <div class="form-group">
        <label for="inputdate">Date of Birth</label>
        <input type="date" class="form-control" id="inputdate" name="Date of Birth">
      </div>
      <div class="form-group">
        <label for="inputaddress">Address</label>
        <input type="text" class="form-control" id="inputaddress" name="address" placeholder="Apartment, studio, floor, or street">
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="inputattainment">Educational Attainment</label>
          <input type="text" class="form-control" id="inputattainment" name="Educational Attainment">
        </div>
        <div class="form-group col-md-4">
          <label for="inputcivil">Civil Status</label>
          <select id="inputcivil" class="form-control" name="civilstatus">
            <option selected>Choose...</option>
            <option value="Single">Single</option>
            <option value="Married">Married</option>
            <option value="Divorced">Divorced</option>
          </select>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="inputoccupation">Occupation</label>
          <input type="text" class="form-control" id="inputoccupation" name="Occupation">
        </div>
        <div class="form-group col-md-4">
          <label for="inputreligion">Religion</label>
          <input type="text" class="form-control" id="inputreligion" name="Religion">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="inputcompany">Company</label>
          <input type="text" class="form-control" id="inputcompany" name="Company">
        </div>
        <div class="form-group col-md-4">
          <label for="inputincome">Monthly Income</label>
          <input type="number" class="form-control" id="inputincome" name="Monthly Income" min="0" step="0.01" placeholder="Monthly Income">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="inputcontact">Contact Number</label>
          <input type="number" class="form-control" id="inputcontact" name="Contact Number">
        </div>
        <div class="form-group col-md-4">
          <label for="inputemail">Email Address</label>
          <input type="email" class="form-control" id="inputemail" name="Email Address" placeholder="Enter your email address">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="clientele">Are you a..?</label>
          <select id="clientele" class="form-control" name="Cilentele Category">
            <option selected>Choose...</option>
            <option value="none">None of the above</option>
            <option value="sp">Solo Parent</option>
            <option value="sc">Senior Citizen</option>
            <option value="osy">Out of School youth</option>
            <option value="pwd">Person with Disability</option>
            <option value="wcyd">Woman in Difficult Circumstances</option>
            <option value="tp">Teenage Pregnant/Mother</option>
          </select>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="inputhealth">What is your Health Condition?</label>
          <select id="inputhealth" class="form-control" name="Health Condition">
            <option selected>Choose...</option>
            <option value="sick">Sickly with maintenance</option>
            <option value="not sickly">Not Sickly</option>
          </select>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="inputliving">What is your Living Condition?</label>
          <select id="inputliving" class="form-control" name="Living Condition">
            <option selected>Choose...</option>
            <option value="Alone">Alone</option>
            <option value="With Spouse">With Spouse</option>
            <option value="With Family">With Family</option>
            <option value="With Relatives">With Relatives</option>
          </select>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="inputdisable">Type of Disability, choose none if you do not have any.</label>
          <select id="inputdisable" class="form-control" name="Disability Type">
            <option selected>Choose...</option>
            <option value="nah">None</option>
            <option value="pyscho">Psychosocial</option>
            <option value="speech">Speech and Language Impairment</option>
            <option value="deaf">Deaf or Hard of Hearing</option>
            <option value="learn">Learning Disability</option>
            <option value="visual">Visual Disability</option>
            <option value="mental">Mental Disability</option>
            <option value="intellect">Intellectual Disability</option>
            <option value="cancer">Cancer</option>
            <option value="rare">Rare Disease</option>
          </select>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="inputskills">What skills have you acquired?</label>
          <textarea class="form-control" id="inputskills" name="Acquired Skills" rows="6"></textarea>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="inputlearnskills">What skills do you want to acquire?</label>
          <textarea class="form-control" id="inputlearnskills" name="Desired Skills" rows="6"></textarea>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="inputschool">Are you willing to go to school?</label>
          <select id="inputschool" class="form-control" name="Willing to go to School">
            <option selected>Choose...</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </div>
      </div>
    </form>
    <h2>II. FAMILY COMPOSITION</h2>
        <table class="table table-bordered" id="submit-form">
            <thead class="thead-light">
                <tr>
                    <th scope="col">Name<br>(First, Middle, Last)</th>
                    <th scope="col">Relationship</th>
                    <th scope="col">Age</th>
                    <th scope="col">Birthday<br>(mm/dd/yy)</th>
                    <th scope="col">Educational Attainment</th>
                    <th scope="col">Occupation</th>
                    <th scope="col">Monthly Income</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="text" class="form-control" placeholder="Name" id="famname"></td>
                    <td><input type="text" class="form-control" placeholder="Relationship" id="famrelation"></td>
                    <td><input type="number" class="form-control" placeholder="Age" id="famage"></td>
                    <td><input type="date" class="form-control"></td>
                    <td><input type="text" class="form-control" placeholder="Educational Attainment" id="fameducation"></td>
                    <td><input type="text" class="form-control" placeholder="Occupation" id="famoccupation"></td>
                    <td><input type="number" class="form-control" placeholder="Monthly Income" min="0" step="0.01" id="famincome"></td>
                </tr>
                <tr>
                    <td><input type="text" class="form-control" placeholder="Name" id="famname2"></td>
                    <td><input type="text" class="form-control" placeholder="Relationship" id="famrelation2"></td>
                    <td><input type="number" class="form-control" placeholder="Age" id="famage2"></td>
                    <td><input type="date" class="form-control"></td>
                    <td><input type="text" class="form-control" placeholder="Educational Attainment" id="fameducation2"></td>
                    <td><input type="text" class="form-control" placeholder="Occupation" id="famoccupation2"></td>
                    <td><input type="number" class="form-control" placeholder="Monthly Income" min="0" step="0.01" id="famincome2"></td>
                </tr>
                <tr>
                    <td><input type="text" class="form-control" placeholder="Name" id="famname3"></td>
                    <td><input type="text" class="form-control" placeholder="Relationship" id="famrelation3"></td>
                    <td><input type="number" class="form-control" placeholder="Age" id="famage3"></td>
                    <td><input type="date" class="form-control"></td>
                    <td><input type="text" class="form-control" placeholder="Educational Attainment" id="fameducation3"></td>
                    <td><input type="text" class="form-control" placeholder="Occupation" id="famoccupation3"></td>
                    <td><input type="number" class="form-control" placeholder="Monthly Income" min="0" step="0.01" id="famincome3"></td>
                </tr>
                <tr>
                    <td><input type="text" class="form-control" placeholder="Name" id="famname4"></td>
                    <td><input type="text" class="form-control" placeholder="Relationship" id="famrelation4"></td>
                    <td><input type="number" class="form-control" placeholder="Age" id="famage4"></td>
                    <td><input type="date" class="form-control"></td>
                    <td><input type="text" class="form-control" placeholder="Educational Attainment" id="fameducation4"></td>
                    <td><input type="text" class="form-control" placeholder="Occupation" id="famoccupation4"></td>
                    <td><input type="number" class="form-control" placeholder="Monthly Income" min="0" step="0.01" id="famincome4"></td>
                </tr>
                <tr>
                    <td><input type="text" class="form-control" placeholder="Name" id="famname5"></td>
                    <td><input type="text" class="form-control" placeholder="Relationship" id="famrelation5"></td>
                    <td><input type="number" class="form-control" placeholder="Age" id="famage5"></td>
                    <td><input type="date" class="form-control"></td>
                    <td><input type="text" class="form-control" placeholder="Educational Attainment" id="fameducation5"></td>
                    <td><input type="text" class="form-control" placeholder="Occupation" id="famoccupation5"></td>
                    <td><input type="number" class="form-control" placeholder="Monthly Income" min="0" step="0.01" id="famincome5"></td>
                </tr>
            </tbody>
        </table>
        <div class="form-row">
          <div class="form-group col-md-1">
            <button type="button" id="export-button" class="btn btn-primary">Submit</button>
          </div>
        </div>
  </div>

  <script>
    const { ipcRenderer } = require('electron');
    const XLSX = require('xlsx');
    const fs = require('fs'); // Import the fs module

    // Function to export data to Excel
    const exportToExcel = async (dir) => {
      // Get form data
      const formData = new FormData(document.getElementById('submit-form'));
      const data = {};
      for (let [key, value] of formData.entries()) {
        data[key] = value;
      }

      try {
        // Read existing Excel file if it exists
        // Read existing Excel file if it exists
        let wb;
        let ws;
        let filePath = `./excel/FormData.xlsx`;
        if (fs.existsSync(filePath)) {
          const existingWb = XLSX.readFile(filePath);
          ws = existingWb.Sheets[existingWb.SheetNames[1]];
          const jsonData = XLSX.utils.sheet_to_json(ws);
          jsonData.push(data); // Append new data to existing data
          ws = XLSX.utils.json_to_sheet(jsonData, { header: Object.keys(data) });
          wb = existingWb; // Use existing workbook
        } else {
          // Create new workbook if the file doesn't exist
          wb = XLSX.utils.book_new();
          ws = XLSX.utils.json_to_sheet([data]);
          XLSX.utils.book_append_sheet(wb, ws, 'Form Data');
        }

  
        // Save workbook to file
        XLSX.writeFile(wb, filePath);
  
        console.log('Excel file saved successfully');
  
        // Reset form
        document.getElementById("submit-form").reset();
      } catch (error) {
        console.error('Error exporting to Excel:', error);
      }
    };
  
    // Export to Excel when button is clicked
    document.getElementById("export-button").addEventListener("click", async () => {
      try {
        const dir = await ipcRenderer.invoke('get-directory');
        await exportToExcel(dir);
      } catch (error) {
        console.error('Error exporting to Excel:', error);
      }
    });
  </script>

</body>
</html>